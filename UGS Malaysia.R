library(readxl)
# data import 
ugsdt= read_excel("UGS_Final.xlsx", skip = 1)
library(plyr)

# data recoding 
climate= replace(ugsdt$`Global climate regulation`, ugsdt$`Global climate regulation` <3, 0)

mcr_clmt= replace(ugsdt$`Microclimate regulation`, ugsdt$`Microclimate regulation` <3,0)

air= replace(ugsdt$`Air filtration`, ugsdt$`Air filtration` <3, 0)

water= replace(ugsdt$`Water cycle regulation`, ugsdt$`Water cycle regulation`<3, 0)
  
runoff= replace(ugsdt$`Runoff reduction`, ugsdt$`Runoff reduction` <3, 0)
  
  
noise= replace(ugsdt$`Noise buffering`, ugsdt$`Noise buffering`<3, 0)
  
  
pest= replace(ugsdt$`Pests regulation`, ugsdt$`Pests regulation`<3, 0)
  
  
erosion= replace(ugsdt$`Erosion control`, ugsdt$`Erosion control` <3, 0)
  
  
biodv= replace(ugsdt$`Biodiversity conservation`, ugsdt$`Biodiversity conservation` <3, 0)
  
  
spirit= replace(ugsdt$`Spiritual values`, ugsdt$`Spiritual values`<3, 0)
  
  
aesth= replace(ugsdt$`Aesthetic values`, ugsdt$`Aesthetic values` <3, 0)

  
outdoor= replace(ugsdt$`Outdoor recreation`, ugsdt$`Outdoor recreation` <3, 0)
  
ecotsm= replace(ugsdt$Ecotourism, ugsdt$Ecotourism <3, 0)
  
  
educ= replace(ugsdt$`Education and research`, ugsdt$Education <3, 0)

 
habitat= replace(ugsdt$`Habitat provision for wildlife`, 
                 ugsdt$`Habitat provision for wildlife`<3, 0)

es_prcpn= climate+ mcr_clmt+ air+runoff+ water+ noise+ pest+ ecotsm+ educ+ 
  aesth+ biodv+ spirit+ outdoor


ed_ev= mapvalues(ugsdt$Education, from = c("1", "2", "3"), 
               to = c("1", "0", "0"))

ed_nonev= mapvalues(ugsdt$Education, from = c("1", "2", "3"), 
                    to = c("0", "1", "0")) 
inc_b= mapvalues(ugsdt$Income, from = c("1", "2", "3"), 
                   to = c("1", "0", "0")) 
inc_m= mapvalues(ugsdt$Income, from = c("1", "2", "3"), 
                  to = c("0", "1", "0")) 
inc_t= mapvalues(ugsdt$Income, from = c("1", "2", "3"), 
                  to = c("0", "0", "1")) 
oc_env= mapvalues(ugsdt$Occupation, from = c("1", "2", "3", "4"), 
                   to = c("1", "1", "0", "0")) 
oc_nonevn= mapvalues(ugsdt$Occupation, from = c("1", "2", "3", "4"), 
                     to = c("0", "1", "0", "0")) 
oc_unemp= mapvalues(ugsdt$Occupation, from = c("1", "2", "3", "4"), 
                    to = c("0", "0", "0", "1")) 
dis_ls1km= mapvalues(ugsdt$`Distance to UGS`, from = c("1", "2", "3"), 
                   to = c("1", "0", "0")) 
dis_1t5km= mapvalues(ugsdt$`Distance to UGS`, from = c("1", "2", "3"), 
                   to = c("0", "1", "0")) 
dis_m5km= mapvalues(ugsdt$`Distance to UGS`, from = c("1", "2", "3"), 
                    to = c("0", "0", "1")) 
vis_fd= mapvalues(ugsdt$`Frequency of visits`, from = c("1", "2", "3"), 
                     to = c("1", "0", "0")) 
vis_1w= mapvalues(ugsdt$`Frequency of visits`, from = c("1", "2", "3"), 
                     to = c("0", "1", "0")) 
vis_ocs= mapvalues(ugsdt$`Frequency of visits`, from = c("1", "2", "3"), 
                    to = c("0", "0", "1")) 

noise4= mapvalues(ugsdt$`Common problems 1`, from= c("1", "2", "3", "4", "5", 
                                                  "6", "7", "8", 
                                                 "1, 2, 3, 4, 5, 6, 7, 8", "2, 4, 5, 8","1, 2, 3, 4, 7, 8",
                                                  
                                                  "1, 2, 4, 7, 8" , "1, 2, 7, 8", "2, 4" ,  
                                                  "2, 3, 4, 7, 8", "1, 2, 4, 6, 7, 8", "4, 6",
                                                  "1, 2, 8", "2, 4, 7, 8", "2, 3, 4",
                                                  
                                                  "2, 4, 5, 6, 7, 8", "1, 2, 4, 8", "1, 4",
                                                  "1, 2, 4, 6, 8", "1, 2, 4, 6, 7", "2, 4, 8", 
                                                  "1, 2, 4", "1, 2, 3, 4, 6, 7, 8", "3, 4",
                                                  
                                                  "1, 2, 3, 4, 5, 6", "1, 2, 7", "1, 2, 4, 5",
                                                  "1, 4, 5", "3, 4, 6, 7, 8", "1, 4, 8" ,
                                                  "2, 4, 6, 7, 8" , "1, 2" , "1, 4, 7, 8",
                                                  
                                                  "1, 4, 6, 7, 8", "1, 6", "1, 3, 5",
                                                  "1, 2, 3, 4", "1, 2, 6, 7, 8", "2, 3, 4, 6",
                                                  "2, 3, 4, 6, 7, 8", "1, 6, 8", "4, 7, 8",
                                                  
                                                  "1, 2, 4, 5, 6, 7, 8", "1, 2, 4, 6","1, 2, 4, 5, 6, 8",
                                                  "4, 6, 8", "1, 2, 3", "2, 4, 6",
                                                  "1, 5", "1, 3", "1, 7, 8",
                                                  
                                                  "1, 2, 3, 5, 6", "2, 5", "1, 2, 3, 4, 8",
                                                  "2, 4, 5, 7","1, 2, 3, 7", "1, 3, 4, 8",
                                                  "2, 3, 6, 7, 8", "1, 7", "4, 5, 6, 8",
                                                  
                                                  "2, 6, 8", "2, 6, 7, 8" , "1, 2, 6",
                                                  "2, 5, 6, 7, 8" , "2, 6","2, 4, 6, 8",
                                                  "2, 3, 4, 5, 7, 8" , "2, 4, 7", "2, 4, 5, 7, 8",
                                                  
                                                  "3, 6, 7, 8", "1, 2, 3, 5" , "1, 2, 6, 8",
                                                  "2, 3, 5, 7, 8", "1, 2, 3, 6, 7, 8", "1, 2, 3, 4, 6, 8",
                                                  "1, 3, 6, 7, 8", "2, 3, 4, 5", "4, 6, 7, 8",
                                                  
                                                  "2, 3, 5, 6, 7, 8", "1, 2, 3, 7, 8", "7, 8",
                                                  "2, 4, 6, 7", "2, 3, 8", "6, 7, 8",
                                                  "2, 3", "2, 3, 4, 8", "2, 7, 8",
                                                  
                                                  "2, 3, 5" , "1, 3, 4, 7, 8", "2, 4, 5",
                                                  "2, 8", "3, 5, 6", "2, 3, 4, 6, 8",
                                                  "2, 3, 7, 8", "3, 4, 8", "1, 3, 4, 6, 7, 8",
                                                  
                                                  "2, 3, 4, 5, 8", "1, 2, 3, 4, 5, 7, 8", "1, 4, 6",
                                                  "1, 2, 3, 6", "2, 5, 7", "1, 2, 5",
                                                  "3, 5, 6, 7", "3, 4, 5, 6", "1, 2, 4, 5, 6, 7",
                                                  
                                                  "1, 2, 3, 4, 5", "1, 2, 4, 5, 7, 8","1, 4, 6, 8",
                                                  "1, 6, 7, 8", "6, 8", "4, 5", 
                                                  "1, 3, 8", "1, 2, 5, 6, 7, 8","2, 4, 5, 6", 
                                                  
                                                 "3, 5","1, 4, 7", "4, 7", 
                                                 "2, 3, 4, 5, 6, 7, 8","3, 4, 5", "2, 5, 6" ,
                                                 "1, 2, 4, 5, 8", "1, 3, 5, 7, 8", "1, 8" ,
                                                 
                                                 "1, 2, 3, 8", "1, 4, 5, 6" , "2, 3, 4, 7",
                                                 "4, 8", "1, 2, 4, 5, 6", "1, 3, 6, 7", 
                                                 "1, 2, 3, 4, 5, 6, 7", "2, 3, 4, 5, 6", "1, 2, 4, 5, 7"),
                                            
                                                   
                 to= c("0", "0", "0", "1", "0", 
                       "0", "0", "0",
                       "1", "1","1",
                       
                       "1", "0" , "1",
                       "1", "1","1",
                       "0", "1","1",
                       
                       "1", "1","1",
                       "1", "1","1",
                       "1", "1","1",
                       
                       "1", "0","1",
                       "1", "1","1",
                       "1", "0","1",
                       
                       "1", "0","0",
                       "1", "0","1",
                       "1", "0","1",
                       
                       "1", "1","1",
                       "1", "0","1",
                       "0", "0", "0",
                       
                       "0", "0", "1",
                       "1", "0","1",
                       "0", "0", "1",
                       
                       "0", "0", "0",
                       "0", "0", "1",
                       "1", "1","1",
                       
                       "0", "0", "0",
                       "0", "0", "1",
                       "1", "0","0",
                       
                       "0", "0", "0",
                       "1", "0","0",
                       "0", "1", "0",
                       
                       "0", "1", "1",
                       "0", "0", "1",
                       "0", "1", "1",
                       
                       "1", "1", "1", 
                       "0", "0", "0",
                       "0", "1", "1",
                       
                       "1", "1","1",
                       "0", "0", "1", 
                       "0", "0","1",
                       
                       "0", "1","1",
                       "1", "1", "0",
                       "1", "0", "0",
                      
                      "0", "1", "1",
                      "1", "1", "0",
                      "1", "1", "1"))

High_temp1= mapvalues(ugsdt$`Common problems 1`, from= c("1", "2", "3", "4", "5", 
                                                  "6", "7", "8", 
                                                  "1, 2, 3, 4, 5, 6, 7, 8", "2, 4, 5, 8","1, 2, 3, 4, 7, 8",
                                                  
                                                  "1, 2, 4, 7, 8" , "1, 2, 7, 8", "2, 4" ,  
                                                  "2, 3, 4, 7, 8", "1, 2, 4, 6, 7, 8", "4, 6",
                                                  "1, 2, 8", "2, 4, 7, 8", "2, 3, 4",
                                                  
                                                  "2, 4, 5, 6, 7, 8", "1, 2, 4, 8", "1, 4",
                                                  "1, 2, 4, 6, 8", "1, 2, 4, 6, 7", "2, 4, 8", 
                                                  "1, 2, 4", "1, 2, 3, 4, 6, 7, 8", "3, 4",
                                                  
                                                  "1, 2, 3, 4, 5, 6", "1, 2, 7", "1, 2, 4, 5",
                                                  "1, 4, 5", "3, 4, 6, 7, 8", "1, 4, 8" ,
                                                  "2, 4, 6, 7, 8" , "1, 2" , "1, 4, 7, 8",
                                                  
                                                  "1, 4, 6, 7, 8", "1, 6", "1, 3, 5",
                                                  "1, 2, 3, 4", "1, 2, 6, 7, 8", "2, 3, 4, 6",
                                                  "2, 3, 4, 6, 7, 8", "1, 6, 8", "4, 7, 8",     #5
                                                  
                                                  "1, 2, 4, 5, 6, 7, 8", "1, 2, 4, 6","1, 2, 4, 5, 6, 8",
                                                  "4, 6, 8", "1, 2, 3", "2, 4, 6",
                                                  "1, 5", "1, 3", "1, 7, 8",
                                                  
                                                  "1, 2, 3, 5, 6", "2, 5", "1, 2, 3, 4, 8",
                                                  "2, 4, 5, 7","1, 2, 3, 7", "1, 3, 4, 8",
                                                  "2, 3, 6, 7, 8", "1, 7", "4, 5, 6, 8",
                                                  
                                                  "2, 6, 8", "2, 6, 7, 8" , "1, 2, 6",
                                                  "2, 5, 6, 7, 8" , "2, 6","2, 4, 6, 8",
                                                  "2, 3, 4, 5, 7, 8" , "2, 4, 7", "2, 4, 5, 7, 8",
                                                  
                                                  "3, 6, 7, 8", "1, 2, 3, 5" , "1, 2, 6, 8",
                                                  "2, 3, 5, 7, 8", "1, 2, 3, 6, 7, 8", "1, 2, 3, 4, 6, 8",
                                                  "1, 3, 6, 7, 8", "2, 3, 4, 5", "4, 6, 7, 8",
                                                  
                                                  "2, 3, 5, 6, 7, 8", "1, 2, 3, 7, 8", "7, 8",
                                                  "2, 4, 6, 7", "2, 3, 8", "6, 7, 8",
                                                  "2, 3", "2, 3, 4, 8", "2, 7, 8",     #10
                                                  
                                                  "2, 3, 5" , "1, 3, 4, 7, 8", "2, 4, 5",
                                                  "2, 8", "3, 5, 6", "2, 3, 4, 6, 8",
                                                  "2, 3, 7, 8", "3, 4, 8", "1, 3, 4, 6, 7, 8",
                                                  
                                                  "2, 3, 4, 5, 8", "1, 2, 3, 4, 5, 7, 8", "1, 4, 6",
                                                  "1, 2, 3, 6", "2, 5, 7", "1, 2, 5",
                                                  "3, 5, 6, 7", "3, 4, 5, 6", "1, 2, 4, 5, 6, 7",
                                                  
                                                  "1, 2, 3, 4, 5", "1, 2, 4, 5, 7, 8","1, 4, 6, 8",
                                                  "1, 6, 7, 8", "6, 8", "4, 5", 
                                                  "1, 3, 8", "1, 2, 5, 6, 7, 8","2, 4, 5, 6", 
                                                  
                                                  "3, 5","1, 4, 7", "4, 7", 
                                                  "2, 3, 4, 5, 6, 7, 8","3, 4, 5", "2, 5, 6" ,
                                                  "1, 2, 4, 5, 8", "1, 3, 5, 7, 8", "1, 8" ,
                                                  
                                                  "1, 2, 3, 8", "1, 4, 5, 6" , "2, 3, 4, 7",
                                                  "4, 8", "1, 2, 4, 5, 6", "1, 3, 6, 7", 
                                                  "1, 2, 3, 4, 5, 6, 7", "2, 3, 4, 5, 6", "1, 2, 4, 5, 7"),
               
               
               to= c("1", "0", "0", "0", "0", 
                     "0", "0", "0",
                     "1", "0","1",  #1
                     
                     "1", "1" , "0",
                     "0", "1","0",
                     "1", "0","0",  #2
                     
                     "0", "1","1",
                     "0", "1","0",
                     "1", "0","0",  #3
                     
                     "1", "1","1",
                     "1", "0","1",
                     "0", "1","1",  #4
                     
                     "1", "1","1",
                     "1", "1","0",
                     "0", "1","0",  #5
                     
                     "1", "1","1",
                     "0", "1","0",
                     "1", "1", "1", #6
                     
                     "1", "0", "1",
                     "0", "1","1",
                     "0", "1", "0", #7
                     
                     "0", "0", "1",
                     "0", "0", "0",
                     "0", "0","0",  #8
                     
                     "0", "1", "1",
                     "0", "1", "1",
                     "1", "0","0",  # 9
                     
                     "0", "1", "0",
                     "0", "0","0",
                     "0", "0", "0", #10
                     
                     "0", "1", "0",
                     "0", "0","0",
                     "0", "0", "0", #11
                     
                     "0", "1", "1", 
                     "1", "0", "1",
                     "0", "0", "1", # 12
                     
                     "1", "1","1",
                     "1", "0", "0", 
                     "1", "1","0",  # 13
                     
                     "0", "1","0",
                     "0", "0", "0",
                     "1", "1", "1", #14
                     
                     "1", "1", "0",
                     "0", "1", "1",
                     "1", "0", "1"))
air_pol2= mapvalues(ugsdt$`Common problems 1`, from= c("1", "2", "3", "4", "5", 
                                                        "6", "7", "8", 
                                                        "1, 2, 3, 4, 5, 6, 7, 8", "2, 4, 5, 8","1, 2, 3, 4, 7, 8",
                                                        
                                                        "1, 2, 4, 7, 8" , "1, 2, 7, 8", "2, 4" ,  
                                                        "2, 3, 4, 7, 8", "1, 2, 4, 6, 7, 8", "4, 6",
                                                        "1, 2, 8", "2, 4, 7, 8", "2, 3, 4",
                                                        
                                                        "2, 4, 5, 6, 7, 8", "1, 2, 4, 8", "1, 4",
                                                        "1, 2, 4, 6, 8", "1, 2, 4, 6, 7", "2, 4, 8", 
                                                        "1, 2, 4", "1, 2, 3, 4, 6, 7, 8", "3, 4",
                                                        
                                                        "1, 2, 3, 4, 5, 6", "1, 2, 7", "1, 2, 4, 5",
                                                        "1, 4, 5", "3, 4, 6, 7, 8", "1, 4, 8" ,
                                                        "2, 4, 6, 7, 8" , "1, 2" , "1, 4, 7, 8",
                                                        
                                                        "1, 4, 6, 7, 8", "1, 6", "1, 3, 5",
                                                        "1, 2, 3, 4", "1, 2, 6, 7, 8", "2, 3, 4, 6",
                                                        "2, 3, 4, 6, 7, 8", "1, 6, 8", "4, 7, 8",     #5
                                                        
                                                        "1, 2, 4, 5, 6, 7, 8", "1, 2, 4, 6","1, 2, 4, 5, 6, 8",
                                                        "4, 6, 8", "1, 2, 3", "2, 4, 6",
                                                        "1, 5", "1, 3", "1, 7, 8",
                                                        
                                                        "1, 2, 3, 5, 6", "2, 5", "1, 2, 3, 4, 8",
                                                        "2, 4, 5, 7","1, 2, 3, 7", "1, 3, 4, 8",
                                                        "2, 3, 6, 7, 8", "1, 7", "4, 5, 6, 8",
                                                        
                                                        "2, 6, 8", "2, 6, 7, 8" , "1, 2, 6",
                                                        "2, 5, 6, 7, 8" , "2, 6","2, 4, 6, 8",
                                                        "2, 3, 4, 5, 7, 8" , "2, 4, 7", "2, 4, 5, 7, 8",   #8
                                                        
                                                        "3, 6, 7, 8", "1, 2, 3, 5" , "1, 2, 6, 8",
                                                        "2, 3, 5, 7, 8", "1, 2, 3, 6, 7, 8", "1, 2, 3, 4, 6, 8",
                                                        "1, 3, 6, 7, 8", "2, 3, 4, 5", "4, 6, 7, 8",
                                                        
                                                        "2, 3, 5, 6, 7, 8", "1, 2, 3, 7, 8", "7, 8",
                                                        "2, 4, 6, 7", "2, 3, 8", "6, 7, 8",
                                                        "2, 3", "2, 3, 4, 8", "2, 7, 8",     #10
                                                        
                                                        "2, 3, 5" , "1, 3, 4, 7, 8", "2, 4, 5",
                                                        "2, 8", "3, 5, 6", "2, 3, 4, 6, 8",
                                                        "2, 3, 7, 8", "3, 4, 8", "1, 3, 4, 6, 7, 8",
                                                        
                                                        "2, 3, 4, 5, 8", "1, 2, 3, 4, 5, 7, 8", "1, 4, 6",
                                                        "1, 2, 3, 6", "2, 5, 7", "1, 2, 5",
                                                        "3, 5, 6, 7", "3, 4, 5, 6", "1, 2, 4, 5, 6, 7",
                                                        
                                                        "1, 2, 3, 4, 5", "1, 2, 4, 5, 7, 8","1, 4, 6, 8",
                                                        "1, 6, 7, 8", "6, 8", "4, 5", 
                                                        "1, 3, 8", "1, 2, 5, 6, 7, 8","2, 4, 5, 6",  #13
                                                        
                                                        "3, 5","1, 4, 7", "4, 7", 
                                                        "2, 3, 4, 5, 6, 7, 8","3, 4, 5", "2, 5, 6" ,
                                                        "1, 2, 4, 5, 8", "1, 3, 5, 7, 8", "1, 8" ,
                                                        
                                                        "1, 2, 3, 8", "1, 4, 5, 6" , "2, 3, 4, 7",
                                                        "4, 8", "1, 2, 4, 5, 6", "1, 3, 6, 7", 
                                                        "1, 2, 3, 4, 5, 6, 7", "2, 3, 4, 5, 6", "1, 2, 4, 5, 7"),
                     
                     
                     to= c("0", "1", "0", "0", "0", 
                           "0", "0", "0",
                           "1", "1","1",  #1
                           
                           "1", "1" , "1",
                           "1", "1","0",
                           "1", "1","1",  #2
                           
                           "1", "1","0",
                           "1", "1","1",
                           "1", "1","0",  #3
                           
                           "1", "1","1",
                           "0", "0","0",
                           "1", "1","0",  #4
                           
                           "0", "0","0",
                           "1", "1","1",
                           "1", "0","0",  #5
                           
                           "1", "1","1",
                           "0", "1","1",
                           "0", "0", "0", #6
                           
                           "1", "1", "1",
                           "1", "1","0",
                           "1", "0", "0", #7
                           
                           "1", "1", "1",
                           "1", "1", "1",
                           "1", "1","1",  #8
                           
                           "0", "1", "1",
                           "1", "1", "1",
                           "0", "1","0",  # 9
                           
                           "1", "1", "0",
                           "1", "1","0",
                           "1", "1", "1", #10
                           
                           "1", "0", "1",
                           "1", "0","1",
                           "1", "0", "0", #11
                           
                           "0", "1", "1", 
                           "1", "0", "1",
                           "0", "0", "1", # 12
                           
                           "1", "1","0",
                           "0", "0", "0", 
                           "0", "1","1",  # 13
                           
                           "0", "0","0",
                           "1", "0", "1",
                           "1", "0", "0", #14
                           
                           "1", "0", "1",
                           "0", "1", "0",
                           "1", "1", "1")) 

flood3= mapvalues(ugsdt$`Common problems 1`, from= c("1", "2", "3", "4", "5", 
                                                       "6", "7", "8", 
                                                       "1, 2, 3, 4, 5, 6, 7, 8", "2, 4, 5, 8","1, 2, 3, 4, 7, 8",
                                                       
                                                       "1, 2, 4, 7, 8" , "1, 2, 7, 8", "2, 4" ,  
                                                       "2, 3, 4, 7, 8", "1, 2, 4, 6, 7, 8", "4, 6",
                                                       "1, 2, 8", "2, 4, 7, 8", "2, 3, 4",      #2
                                                       
                                                       "2, 4, 5, 6, 7, 8", "1, 2, 4, 8", "1, 4",
                                                       "1, 2, 4, 6, 8", "1, 2, 4, 6, 7", "2, 4, 8", 
                                                       "1, 2, 4", "1, 2, 3, 4, 6, 7, 8", "3, 4",      #3
                                                       
                                                       "1, 2, 3, 4, 5, 6", "1, 2, 7", "1, 2, 4, 5",
                                                       "1, 4, 5", "3, 4, 6, 7, 8", "1, 4, 8" ,
                                                       "2, 4, 6, 7, 8" , "1, 2" , "1, 4, 7, 8",      #4
                                                       
                                                       "1, 4, 6, 7, 8", "1, 6", "1, 3, 5",
                                                       "1, 2, 3, 4", "1, 2, 6, 7, 8", "2, 3, 4, 6",
                                                       "2, 3, 4, 6, 7, 8", "1, 6, 8", "4, 7, 8",     #5
                                                       
                                                       "1, 2, 4, 5, 6, 7, 8", "1, 2, 4, 6","1, 2, 4, 5, 6, 8",
                                                       "4, 6, 8", "1, 2, 3", "2, 4, 6",
                                                       "1, 5", "1, 3", "1, 7, 8",  #6
                                                       
                                                       "1, 2, 3, 5, 6", "2, 5", "1, 2, 3, 4, 8",
                                                       "2, 4, 5, 7","1, 2, 3, 7", "1, 3, 4, 8",
                                                       "2, 3, 6, 7, 8", "1, 7", "4, 5, 6, 8",      #7
                                                       
                                                       "2, 6, 8", "2, 6, 7, 8" , "1, 2, 6",
                                                       "2, 5, 6, 7, 8" , "2, 6","2, 4, 6, 8",
                                                       "2, 3, 4, 5, 7, 8" , "2, 4, 7", "2, 4, 5, 7, 8",   #8
                                                       
                                                       "3, 6, 7, 8", "1, 2, 3, 5" , "1, 2, 6, 8",
                                                       "2, 3, 5, 7, 8", "1, 2, 3, 6, 7, 8", "1, 2, 3, 4, 6, 8",
                                                       "1, 3, 6, 7, 8", "2, 3, 4, 5", "4, 6, 7, 8",      #9
                                                       
                                                       "2, 3, 5, 6, 7, 8", "1, 2, 3, 7, 8", "7, 8",
                                                       "2, 4, 6, 7", "2, 3, 8", "6, 7, 8",
                                                       "2, 3", "2, 3, 4, 8", "2, 7, 8",     #10
                                                       
                                                       "2, 3, 5" , "1, 3, 4, 7, 8", "2, 4, 5",
                                                       "2, 8", "3, 5, 6", "2, 3, 4, 6, 8",
                                                       "2, 3, 7, 8", "3, 4, 8", "1, 3, 4, 6, 7, 8", #11
                                                       
                                                       "2, 3, 4, 5, 8", "1, 2, 3, 4, 5, 7, 8", "1, 4, 6",
                                                       "1, 2, 3, 6", "2, 5, 7", "1, 2, 5",
                                                       "3, 5, 6, 7", "3, 4, 5, 6", "1, 2, 4, 5, 6, 7",
                                                       
                                                       "1, 2, 3, 4, 5", "1, 2, 4, 5, 7, 8","1, 4, 6, 8",
                                                       "1, 6, 7, 8", "6, 8", "4, 5", 
                                                       "1, 3, 8", "1, 2, 5, 6, 7, 8","2, 4, 5, 6",  #13
                                                       
                                                       "3, 5","1, 4, 7", "4, 7", 
                                                       "2, 3, 4, 5, 6, 7, 8","3, 4, 5", "2, 5, 6" ,
                                                       "1, 2, 4, 5, 8", "1, 3, 5, 7, 8", "1, 8" ,
                                                       
                                                       "1, 2, 3, 8", "1, 4, 5, 6" , "2, 3, 4, 7",
                                                       "4, 8", "1, 2, 4, 5, 6", "1, 3, 6, 7", 
                                                       "1, 2, 3, 4, 5, 6, 7", "2, 3, 4, 5, 6", "1, 2, 4, 5, 7"),
                    
                    
                    to= c("0", "0", "1", "0", "0", 
                          "0", "0", "0",
                          "1", "0","1",  #1
                          
                          "0", "0", "0",
                          "1", "0", "0",
                          "0", "0","1",  #2
                          
                          "0", "0", "0",
                          "0", "0", "0",
                          "0", "1","1",  #3
                          
                          "0", "0","1",
                          "0", "1","0",
                          "0", "0", "0",  #4
                          
                          "0", "0","1",
                          "1", "0","1",
                          "1", "0","0",  #5
                          
                          "0", "0", "0",
                          "0", "1","0",
                          "1", "0", "0", #6
                          
                          "1", "0", "1",
                          "0", "1","1",
                          "1", "0", "0", #7
                          
                          "0", "0", "0",
                          "0", "0", "0",
                          "1", "1","0",  #8
                          
                          "1", "1", "0",
                          "1", "1", "1",
                          "1", "1","0",  # 9
                          
                          "1", "1", "0",
                          "1", "0","1",
                          "0", "0", "0", #10
                          
                          "1", "1", "0",
                          "0", "1","1",
                          "1", "1", "1", #11
                          
                          "1", "1", "0", 
                          "1", "0", "0",
                          "1", "1", "0", # 12
                          
                          "1", "0","0",
                          "0", "0", "0", 
                          "1", "0","0",  # 13
                          
                          "1", "0","0",
                          "1", "1", "0",
                          "0", "1", "0", #14
                          
                          "1", "0", "1",
                          "0", "0", "1",
                          "1", "1", "0")) 

land5= mapvalues(ugsdt$`Common problems 1`, from= c("1", "2", "3", "4", "5", 
                                                     "6", "7", "8", 
                                                     "1, 2, 3, 4, 5, 6, 7, 8", "2, 4, 5, 8","1, 2, 3, 4, 7, 8",
                                                     
                                                     "1, 2, 4, 7, 8" , "1, 2, 7, 8", "2, 4" ,  
                                                     "2, 3, 4, 7, 8", "1, 2, 4, 6, 7, 8", "4, 6",
                                                     "1, 2, 8", "2, 4, 7, 8", "2, 3, 4",      #2
                                                     
                                                     "2, 4, 5, 6, 7, 8", "1, 2, 4, 8", "1, 4",
                                                     "1, 2, 4, 6, 8", "1, 2, 4, 6, 7", "2, 4, 8", 
                                                     "1, 2, 4", "1, 2, 3, 4, 6, 7, 8", "3, 4",      #3
                                                     
                                                     "1, 2, 3, 4, 5, 6", "1, 2, 7", "1, 2, 4, 5",
                                                     "1, 4, 5", "3, 4, 6, 7, 8", "1, 4, 8" ,
                                                     "2, 4, 6, 7, 8" , "1, 2" , "1, 4, 7, 8",      #4
                                                     
                                                     "1, 4, 6, 7, 8", "1, 6", "1, 3, 5",
                                                     "1, 2, 3, 4", "1, 2, 6, 7, 8", "2, 3, 4, 6",
                                                     "2, 3, 4, 6, 7, 8", "1, 6, 8", "4, 7, 8",     #5
                                                     
                                                     "1, 2, 4, 5, 6, 7, 8", "1, 2, 4, 6","1, 2, 4, 5, 6, 8",
                                                     "4, 6, 8", "1, 2, 3", "2, 4, 6",
                                                     "1, 5", "1, 3", "1, 7, 8",  #6
                                                     
                                                     "1, 2, 3, 5, 6", "2, 5", "1, 2, 3, 4, 8",
                                                     "2, 4, 5, 7","1, 2, 3, 7", "1, 3, 4, 8",
                                                     "2, 3, 6, 7, 8", "1, 7", "4, 5, 6, 8",      #7
                                                     
                                                     "2, 6, 8", "2, 6, 7, 8" , "1, 2, 6",
                                                     "2, 5, 6, 7, 8" , "2, 6","2, 4, 6, 8",
                                                     "2, 3, 4, 5, 7, 8" , "2, 4, 7", "2, 4, 5, 7, 8",   #8
                                                     
                                                     "3, 6, 7, 8", "1, 2, 3, 5" , "1, 2, 6, 8",
                                                     "2, 3, 5, 7, 8", "1, 2, 3, 6, 7, 8", "1, 2, 3, 4, 6, 8",
                                                     "1, 3, 6, 7, 8", "2, 3, 4, 5", "4, 6, 7, 8",      #9
                                                     
                                                     "2, 3, 5, 6, 7, 8", "1, 2, 3, 7, 8", "7, 8",
                                                     "2, 4, 6, 7", "2, 3, 8", "6, 7, 8",
                                                     "2, 3", "2, 3, 4, 8", "2, 7, 8",     #10
                                                     
                                                     "2, 3, 5" , "1, 3, 4, 7, 8", "2, 4, 5",
                                                     "2, 8", "3, 5, 6", "2, 3, 4, 6, 8",
                                                     "2, 3, 7, 8", "3, 4, 8", "1, 3, 4, 6, 7, 8", #11
                                                     
                                                     "2, 3, 4, 5, 8", "1, 2, 3, 4, 5, 7, 8", "1, 4, 6",
                                                     "1, 2, 3, 6", "2, 5, 7", "1, 2, 5",
                                                     "3, 5, 6, 7", "3, 4, 5, 6", "1, 2, 4, 5, 6, 7",
                                                     
                                                     "1, 2, 3, 4, 5", "1, 2, 4, 5, 7, 8","1, 4, 6, 8",
                                                     "1, 6, 7, 8", "6, 8", "4, 5", 
                                                     "1, 3, 8", "1, 2, 5, 6, 7, 8","2, 4, 5, 6",  #13
                                                     
                                                     "3, 5","1, 4, 7", "4, 7", 
                                                     "2, 3, 4, 5, 6, 7, 8","3, 4, 5", "2, 5, 6" ,
                                                     "1, 2, 4, 5, 8", "1, 3, 5, 7, 8", "1, 8" ,
                                                     
                                                     "1, 2, 3, 8", "1, 4, 5, 6" , "2, 3, 4, 7",
                                                     "4, 8", "1, 2, 4, 5, 6", "1, 3, 6, 7", 
                                                     "1, 2, 3, 4, 5, 6, 7", "2, 3, 4, 5, 6", "1, 2, 4, 5, 7"),
                  
                  
                  to= c("0", "0", "0", "0", "1", 
                        "0", "0", "0",
                        "1", "1","0",  #1
                        
                        "0", "0", "0",
                        "0", "0", "0",
                        "0", "0", "0",  #2
                        
                        "1", "0", "0",
                        "0", "0", "0",
                        "0", "0", "0",  #3
                        
                        "1", "0","1",
                        "1", "0","0",
                        "0", "0", "0",  #4
                        
                        "0", "0","1",
                        "0", "0", "0",
                        "0", "0", "0",  #5
                        
                        "1", "0", "1",
                        "0", "0", "0",
                        "1", "0", "0", #6
                        
                        "1", "1", "0",
                        "1", "0","0",
                        "0", "0", "1", #7
                        
                        "0", "0", "0",
                        "1", "0", "0",
                        "1", "0","1",  #8
                        
                        "0", "1", "0",
                        "1", "0", "0",
                        "0", "1","0",  # 9
                        
                        "1", "0", "0",
                        "0", "0", "0",
                        "0", "0", "0", #10
                        
                        "1", "0", "1",
                        "0", "1","0",
                        "0", "0", "0", #11
                        
                        "1", "1", "0", 
                        "0", "1", "1",
                        "1", "1", "1", # 12
                        
                        "1", "1","0",
                        "0", "1", "1", 
                        "0", "1","0",  # 13
                        
                        "1", "0","0",
                        "1", "1", "1",
                        "1", "1", "0", #14
                        
                        "0", "1", "0",
                        "0", "1", "0",
                        "1", "1", "1")) 

ugs_cdt= cbind(ugsdt, es_prcpn,
               ed_ev, ed_nonev, inc_b, inc_m,inc_t, oc_env, oc_nonevn, oc_unemp, 
               dis_ls1km, dis_1t5km, dis_m5km, vis_fd, vis_1w, vis_ocs, 
               noise4, air_pol2, High_temp1, flood3, land5, ugs_prcp) 

library(dplyr)
## log transformation

# model 

mod_espcp= lm (ugs_prcp~ ed_ev+ ed_nonev+ inc_m+ inc_t+ oc_env+ oc_nonevn+ oc_unemp+ 
             dis_ls1km+ dis_1t5km+ dis_m5km+ vis_fd+ vis_1w+ 
               air_pol2+ High_temp1+ flood3, data = ugs_cdt)
summary(mod_espcp)











######## rough woks ###########


climate= as.numeric( mapvalues(ugsdt$`Global climate regulation`, from = c("2", "3", "4", "5"), 
                               to = c("0", "1", "1", "1")))

mcr_clmt= as.numeric( mapvalues(ugsdt$`Microclimate regulation`, from = c("1", "2", "3", "4", "5"), 
                                to = c("0", "0", "1", "1", "1")))

air= as.numeric(mapvalues(ugsdt$`Air filtration`, from = c("1", "2", "3", "4", "5"), 
                          to = c("0", "0", "1", "1", "1")))

water= mapvalues(ugsdt$`Water cycle regulation`, from = c("1", "2", "3", "4", "5"), 
                 to = c("0", "0", "1", "1", "1"))

runoff= mapvalues(ugsdt$`Runoff reduction`, from = c("1", "2", "3", "4", "5"), 
                  to = c("0", "0", "1", "1", "1"))


noise= mapvalues(ugsdt$`Noise buffering`, from = c("1", "2", "3", "4", "5"), 
                 to = c("0", "0", "1", "1", "1"))


pest= mapvalues(ugsdt$`Pests regulation`, from = c("1", "2", "3", "4", "5"), 
                to = c("0", "0", "1", "1", "1"))


erosion= mapvalues(ugsdt$`Erosion control`, from = c("1", "2", "3", "4", "5"), 
                   to = c("0", "0", "1", "1", "1"))


biodv= mapvalues(ugsdt$`Biodiversity conservation`, from = c("1", "2", "3", "4", "5"), 
                 to = c("0", "0", "1", "1", "1"))


spirit= mapvalues(ugsdt$`Spiritual values`, from = c("1", "2", "3", "4", "5"), 
                  to = c("0", "0", "1", "1", "1"))


aesth= mapvalues(ugsdt$`Aesthetic values`, from = c("1", "2", "3", "4", "5"), 
                 to = c("0", "0", "1", "1", "1"))


outdoor= mapvalues(ugsdt$`Outdoor recreation`, from = c("1", "2", "3", "4", "5"), 
                   to = c("0", "0", "1", "1", "1"))

ecotsm= mapvalues(ugsdt$Ecotourism, from = c("1", "2", "3", "4", "5"), 
                  to = c("0", "0", "1", "1", "1"))


educ= mapvalues(ugsdt$Education, from = c("1", "2", "3"), 
                to = c("0", "0", "1", "1", "1"))


habitat= mapvalues(ugsdt$`Habitat provision for wildlife`, from = c("1", "2", "3", "4", "5"), 
                   to = c("0", "0", "1", "1", "1"))

es_prcp= climat + mcr_clmt + air+ water+ runoff+ noise+  
  erosion+ biodv+ spirit+ aesth+ outdoor+ ecotsm+ educ+ habitat
ugs_prcp= (ugsdt$`Global climate regulation`+ugsdt$`Microclimate regulation`+ugsdt$`Air filtration`+ 
             ugsdt$`Water cycle regulation`+ ugsdt$`Noise buffering`+ ugsdt$`Pests regulation`+ ugsdt$Ecotourism+
             ugsdt$`Education and research`+ ugsdt$`Aesthetic values`+ ugsdt$`Biodiversity conservation`+ ugsdt$`Spiritual values`+ 
             ugsdt$`Outdoor recreation`)